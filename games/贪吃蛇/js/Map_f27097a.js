function Map(t,r,a){this.row=t,this.col=r,this.dom=document.createElement("div"),this.arr=[],this.snake=new Snake,this.timer=null,this.food=null,this.wall=new Wall(a),this.init()}Map.prototype.init=function(){this.fillDom(),this.up(),this.domreset(),this.initFood(),this.bindEvent()},Map.prototype.initFood=function(){for(var t=parseInt(Math.random()*this.col),r=parseInt(Math.random()*this.row),a=0;a<this.snake.bodyarr.length;a++)for(;t===this.snake.bodyarr[a].x&&r===this.snake.bodyarr[a].y||t===this.snake.headarr[0].x&&r===this.snake.headarr[0].y;)t=parseInt(Math.random()*this.col),r=parseInt(Math.random()*this.row),a=0;this.food=new Food(t,r)},Map.prototype.check=function(){if(this.snake.headarr[0].x>this.col-1||this.snake.headarr[0].x<0||this.snake.headarr[0].y>this.row-1||this.snake.headarr[0].y<0)return alert("失败"),this.end(),!0;this.snake.headarr[0].x===this.food.position.x&&this.snake.headarr[0].y===this.food.position.y&&(this.initFood(),this.snake.growup());for(var t=0;t<this.snake.bodyarr.length;t++)if(this.snake.headarr[0].x===this.snake.bodyarr[t].x&&this.snake.headarr[0].y===this.snake.bodyarr[t].y)return this.end(),!0;for(var t=0;t<this.wall.arr.length;t++)if(this.snake.headarr[0].x===this.wall.arr[t].x&&this.snake.headarr[0].y===this.wall.arr[t].y)return this.end(),!0},Map.prototype.end=function(){clearInterval(this.timer)},Map.prototype.start=function(){var t=this;this.end(),this.timer=setInterval(function(){t.snake.move(),t.check()||t.render()},500)},Map.prototype.fillDom=function(){var t=document.createElement("div");t.className="row";for(var r=0;r<this.col;r++){var a=document.createElement("div");a.className="col",t.appendChild(a)}for(var r=0;r<this.row;r++){var e=t.cloneNode(!0);this.arr.push(e.childNodes),this.dom.appendChild(e)}this.dom.className="map"},Map.prototype.up=function(){document.body.appendChild(this.dom)},Map.prototype.domreset=function(){var t=this.dom.clientWidth,r=this.dom.clientHeight;this.dom.style.marginLeft=-t/2+"px",this.dom.style.marginTop=-r/2+"px"},Map.prototype.bindEvent=function(){var t=this;document.onkeydown=function(r){switch(r.preventDefault(),r.keyCode){case 37:case 38:case 39:case 40:t.snake.changeForward(r.keyCode)}}},Map.prototype.render=function(){for(var t=0;t<this.arr.length;t++)for(var r=0;r<this.arr[t].length;r++)this.arr[t][r].style="";for(var t=0;t<this.snake.headarr.length;t++)this.arr[this.snake.headarr[t].x][this.snake.headarr[t].y].style.background="blue";for(var t=0;t<this.snake.bodyarr.length;t++)this.arr[this.snake.bodyarr[t].x][this.snake.bodyarr[t].y].style.background="red";for(var t=0;t<this.wall.arr.length;t++)this.arr[this.wall.arr[t].x][this.wall.arr[t].y].style.background="purple";this.arr[this.food.position.x][this.food.position.y].style.background="black"},Map.prototype.down=function(){document.body.removeChild(this.dom)};